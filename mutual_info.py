import csv
import numpy as np
from sklearn import feature_selection
import scipy as sp

def write_csv(file_name,data):
    with open(file_name, "a") as f:
        for i in data:
            f.write(str(i))
            f.write(",")
        f.write("\n")


apps=[]
targets=[]
with open('appSec.csv') as csvfile:
    spamreader = csv.reader(csvfile,delimiter=',', quotechar='|')
    for row in spamreader:
        for i in range(len(row)):
            row[i] = row[i].replace(' ', '')
            row[i] = row[i].replace('"', '')
        if 'mal' in (row[1]).lower():
            targets.append(1)
            row=np.array(row)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=row.astype(np.int)
            apps.append(row)
        elif 'ben' in (row[1]).lower():
            targets.append(0)
            row=np.array(row)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=row.astype(np.int)
            apps.append(row)

with open('appSec1.csv') as csvfile:
    spamreader = csv.reader(csvfile,delimiter=',', quotechar='|')
    for row in spamreader:
        for i in range(len(row)):
            row[i] = row[i].replace(' ', '')
            row[i] = row[i].replace('"', '')
        if 'mal' in (row[1]).lower():
            targets.append(1)
            row=np.array(row)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=row.astype(np.int)
            apps.append(row)
        elif 'ben' in (row[1]).lower():
            targets.append(0)
            row=np.array(row)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=np.delete(row,0)
            row=row.astype(np.int)
            apps.append(row)


a=sp.sparse.csr_matrix(apps)
res=feature_selection.mutual_info_classif(a,targets)
for i in range(len(res)):
    results=[i,str(res[i])]
    write_csv('j_mut.csv',results)
